# snp-annotation
Contact: m.lundberg@uq.net.au

## What it does:
This tool annotates RSID to chromosmal positions.

----

## Prerequisites:
- Script was tested with the following versions installed:
 - Anaconda2
 - Pandas: 0.22.0
 - Numpy: 1.14.3
 - Pysam: 0.14.1
 
## Getting Started
In order to download the SNP annotation tool, you should clone this repository via the commands
```  
git clone git@github.com:MischaLundberg/snp-annotation.git
cd snp-annotation
```

In order to install the Python dependencies, you will need a Python distribution such as [Anaconda](https://store.continuum.io/cshop/anaconda/) and a package manager. In the following, I will refer to Anaconda. After installing Anaconda, run the following commands to create an environment with all needed dependencies:

```
conda env create --file environment.yml
source activate snpannotation

## to deactivate the environment, type
#conda deactivate
```

In case you are updating your current version of the method, it would be best practice to also update your environment to the updated prerequisetes.
If you are using a Anaconda environment, you can do so by typing
```
conda env update --name snpannotation --file environment.yml
```


If you receive any errors while running the SNP annotation tool, please ensure your versioning for the prerequisites is according to the tested versions.

----
## How to start a run?

First things first.
In your first run, you will need to download the needed databases (automatically the method will use HG37). 
The download can be achieved through adding the command ```--creade_database```.
The method can take care of strandedness information within your files by using ```--strandedness```.

The basic call of the method wouldbe ```./annotate_rsid.py -i input_sumstats.txt -o updated_sumstats.txt --create_database```.
This assumes that your input file is tab separated and contains the following columns CHR, BP, A1, A2.


## Arguments that can be used

```-i``` defaulting to ```none```; what it does: Target input summary statistics file or list of files separated by \",\" or a file containing all input files separated by \",\" (the file name of this has to be files.txt, e.g. generated by the following command:  ls *.fastGWA.txt.gz | tr \'\n\' \',\' > files.txt); has to contain CHR, BP, A1, A2 (these labels are needed for annotation)')

```-r``` defaulting to ```./dbsnp/dbsnp.tsv.gz```; what it does: Reference file containing RSIDs and chromosomal positions with allele information; has to contain CHR, BP, RSID, A1, A2 (these labels are needed for annotation). Deflaut: \"./dbsnp/dbsnp.tsv.gz\"')

```-o``` defaulting to ```none```; what it does: Target output File, for name of the file in argument i leave blank (will be extended by \"sumstats_rsid.bed\"')

```--nochr``` defaulting to ```False```; what it does: Make both input files nochr (no \"chr\" prefix to the chromosomal location)')

```--sort``` defaulting to ```False```; what it does: Sorts the BED File')

```--i_sep``` defaulting to ```\t```; what it does: Set the separator used for the -i option (\\t is default)')

```--r_sep``` defaulting to ```\t```; what it does: Set the separator used for the -r option (\\t is default)')

```--o_sep``` defaulting to ```\t```; what it does: Set the separator used for the -o option (\\t is default)')

```--strandedness``` defaulting to ```False```; what it does: Set if strandedness is unknown or different between the two input files')

```-rck``` defaulting to ```False```; what it does: (reference contains key) - If reference file contains a column \"KEY\" which harbors (), then set this key. In this case, the needed KEY is not generated, but used from your input. This will speed-up the whole process by far (depending on the size of your reference file). Setting this key, activates the strandedness option!')

```-mis``` defaulting to ```,```; what it does: mass input separator; separator of the files to use if using files.txt as input argument for -i option. Default is \',\'')

```-m``` defaulting to ```False```; what it does: Set this key, if autodetection of a file containing filenames to run as input doesnt work.')

```--create_database``` defaulting to ```False```; what it does: downloads and prepares the snpdb database that is used for annotating SNPs without rsid. Needs to be ran as first initialization step')

```--snps``` defaulting to ```common```; what it does: select which database you want to use/align for; options: \"common\" (only common SNPs) \"all\" (common and rare SNPs);deflaut \"common\"')
